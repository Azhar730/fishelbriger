generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  name      String
  email     String   @unique
  password  String
  photoURL String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Client {
  id                             String                           @id @default(auto()) @map("_id") @db.ObjectId
  name                           String
  primaryCalculator              PrimaryCalculator[]
  MonthlyExpenses                MonthlyExpenses[]
  OtherMonthlyDebt               OtherMonthlyDebt[]
  MonthlyIncome                  MonthlyIncome[]
  CoSignerObligations            CoSignerObligations[]
  RefinanceCalculator            RefinanceCalculator[]
  CashoutCalculator              CashoutCalculator[]
  RateTermThisYearCalculator     RateTermThisYearCalculator[]
  RateTermPreviousYearCalculator RateTermPreviousYearCalculator[]
  InvestmentLoan                 InvestmentLoan[]
  FhaLoan                        FhaLoan[]
  FhaMonthlyExpenses             FhaMonthlyExpenses[]
}

// PRIMARY HOME PAGE

// primary calculator
model PrimaryCalculator {
  id                 String   @id @default(auto()) @map("_id") @db.ObjectId
  clientId           String   @db.ObjectId
  client             Client   @relation(fields: [clientId], references: [id])
  purchasePrice      Float    @default(0)
  loanToValuePercent Float    @default(0)
  downPayment        Float    @default(0)
  loanAmount         Float    @default(0)
  ratePercent        Float    @default(0)
  closingCost        Float    @default(0)
  mortgagePayment    Int      @default(0)
  taxAndInsurance    Float    @default(0)
  pmi                Float    @default(0)
  hoaFees            Float    @default(0)
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt
}

model RefinanceCalculator {
  id                  String   @id @default(auto()) @map("_id") @db.ObjectId
  clientId            String   @db.ObjectId
  client              Client   @relation(fields: [clientId], references: [id])
  propertyValue       Float    @default(0)
  loanToValuePercent  Float    @default(0)
  loanAmount          Float    @default(0)
  ratePercent         Float    @default(0)
  mortgagePayment     Int      @default(0)
  taxAndInsurance     Float    @default(0)
  pmi                 Float    @default(0)
  hoaFees             Float    @default(0)
  totalMonthlyPayment Float    @default(0)
  closingCost         Float    @default(0)
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
}

model CashoutCalculator {
  id                  String   @id @default(auto()) @map("_id") @db.ObjectId
  clientId            String   @db.ObjectId
  client              Client   @relation(fields: [clientId], references: [id])
  purchasePrice       Float    @default(0)
  loanToValuePercent  Float    @default(0)
  downPayment         Float    @default(0)
  loanAmount          Float    @default(0)
  ratePercent         Float    @default(0)
  mortgagePayment     Int      @default(0)
  taxAndInsurance     Float    @default(0)
  pmi                 Float    @default(0)
  hoaFees             Float    @default(0)
  renovationCosts     Float    @default(0)
  otherExpenses       Float    @default(0)
  totalMonthlyPayment Float    @default(0)
  closingCost         Float    @default(0)
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
}

// rate term calculation
model RateTermThisYearCalculator {
  id                String   @id @default(auto()) @map("_id") @db.ObjectId
  clientId          String   @db.ObjectId
  client            Client   @relation(fields: [clientId], references: [id])
  incorporationDate DateTime
  businessName      String
  k1Income          Float    @default(0)
  ownershipPercent  Float    @default(0)
  depreciation      Float    @default(0)
  amortization      Float    @default(0)
  totalIncome       Float    @default(0)
}

model RateTermPreviousYearCalculator {
  id                String   @id @default(auto()) @map("_id") @db.ObjectId
  clientId          String   @db.ObjectId
  client            Client   @relation(fields: [clientId], references: [id])
  incorporationDate DateTime
  businessName      String
  k1Income          Float    @default(0)
  ownershipPercent  Float    @default(0)
  depreciation      Float    @default(0)
  amortization      Float    @default(0)
  totalIncome       Float    @default(0)
}

// Monthly expenses
model MonthlyExpenses {
  id                     String @id @default(auto()) @map("_id") @db.ObjectId
  clientId               String @db.ObjectId
  client                 Client @relation(fields: [clientId], references: [id])
  primaryMortgagePayment Float  @default(0)
  propertyTax            Float  @default(0)
  insurance              Float  @default(0)
  pmi                    Float  @default(0)
  hoa                    Float  @default(0)
}

model OtherMonthlyDebt {
  id           String @id @default(auto()) @map("_id") @db.ObjectId
  studentLoans Float  @default(0)
  creditCards  Float  @default(0)
  carLease     Float  @default(0)
  personalLoan Float  @default(0)
  otherDebt    Float  @default(0)
  clientId     String @db.ObjectId
  client       Client @relation(fields: [clientId], references: [id])
}

model CoSignerObligations {
  id                     String @id @default(auto()) @map("_id") @db.ObjectId
  coSignerDebits         Float  @default(0)
  coSignerMortgageOrRent Float  @default(0)
  coSignerHOA            Float  @default(0)
  coSignerCarLease       Float  @default(0)
  coSignerLoans          Float  @default(0)
  coSignerCreditCards    Float  @default(0)
  clientId               String @db.ObjectId
  client                 Client @relation(fields: [clientId], references: [id])
}

model MonthlyIncome {
  id             String @id @default(auto()) @map("_id") @db.ObjectId
  borrowerSalary Float  @default(0)
  childSupport   Float  @default(0)
  subjectAddUnit Float  @default(0)
  totalIncome    Float  @default(0)
  clientId       String @db.ObjectId
  client         Client @relation(fields: [clientId], references: [id])
}

// investment page calculator
model InvestmentLoan {
  id                 String   @id @default(auto()) @map("_id") @db.ObjectId
  clientId           String   @db.ObjectId
  client             Client   @relation(fields: [clientId], references: [id])
  purchasePrice      Float    @default(0)
  loanToValuePercent Float    @default(0)
  downPayment        Float    @default(0)
  loanAmount         Float    @default(0)
  ratePercent        Float    @default(0)
  closingCost        Float    @default(0)
  mortgagePayment    Int      @default(0)
  taxAndInsurance    Float    @default(0)
  pmi                Float    @default(0)
  hoaFees            Float    @default(0)
  renovationCosts    Float    @default(0)
  otherExpenses      Float    @default(0)
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt
}

// FHA page calculator
model FhaLoan {
  id                  String   @id @default(auto()) @map("_id") @db.ObjectId
  clientId            String   @db.ObjectId
  client              Client   @relation(fields: [clientId], references: [id])
  purchasePrice       Float    @default(0)
  loanToValuePercent  Float    @default(0)
  downPayment         Float    @default(0)
  loanAmount          Float    @default(0)
  ufmip               Float    @default(0)
  ratePercent         Float    @default(0)
  mortgagePayment     Int      @default(0)
  taxAndInsurance     Float    @default(0)
  mip                 Float    @default(0)
  hoaFees             Float    @default(0)
  totalMonthlyPayment Float    @default(0)
  closingCost         Float    @default(0)
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
}

model FhaMonthlyExpenses {
  id                     String @id @default(auto()) @map("_id") @db.ObjectId
  clientId               String @db.ObjectId
  client                 Client @relation(fields: [clientId], references: [id])
  primaryMortgagePayment Float  @default(0)
  propertyTax            Float  @default(0)
  insurance              Float  @default(0)
  mip                    Float  @default(0)
  hoa                    Float  @default(0)
}

// Fix And Flip page calculator
model FixAndFlipCalculator {
  id String @id @default(auto()) @map("_id") @db.ObjectId

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// HELOC page calculator
model HELOCCalculator {
  id String @id @default(auto()) @map("_id") @db.ObjectId

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// model Client {
//   id                  String @id @default(auto()) @map("_id") @db.ObjectId
//   clientName          String @unique
//   propertyName        String
//   appraisedValue      Float
//   purchasePrice       Float
//   loanAmount          Float
//   rate                Float
//   numberOfPaymentDone Int
//   monthlyPayment      Float
//   currentLoanAmount   Float
//   myCommission        Float
//   note                String

//   createdAt         DateTime            @default(now())
//   updatedAt         DateTime            @updatedAt
//   primaryCalculator PrimaryCalculator[]
// }
enum PaymentType {
  PIPELINE
  CLOSED
}

enum CoSignerDebtType {
  CO_SIGNER_DEBITS
  CO_SIGNER_MORTGAGE_OR_RENT
  CO_SIGNER_HOA
  CO_SIGNER_CAR_LEASE
  CO_SIGNER_LOANS
  CO_SIGNER_CREDIT_CARDS
}

enum MonthlyDebtType {
  STUDENT_LOANS
  CREDIT_CARDS
  CAR_LEASE
  PERSONAL_LOAN
  OTHER_DEBT
}
